

function getHtmlPopupContents_community_add_youtube_video(el) {
    let html = '';

    html = `
        <div class = "edit_profile_picture">
            <div class = "popup_contents_top">
                <div class = "popup_contents_top_left md-ripples" onclick = "backPopupContents();" onmouseenter = "hoverInformation(this, getLanguage('popup_contents:back'));">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50" height="50" viewBox="0 0 50 50"><defs><clipPath id="b"><rect width="50" height="50"></rect></clipPath></defs><g id="a" clip-path="url(#b)"><g transform="translate(-12.086 -0.24)"><rect width="3" height="35" rx="1.5" transform="translate(36.399 0.479) rotate(45)"></rect><rect width="3" height="35" rx="1.5" transform="translate(38.521 47.879) rotate(135)"></rect></g><rect width="49" height="3" rx="1.5" transform="translate(1 23.5)"></rect></g></svg>
                </div>
                <div class = "popup_contents_top_right">
                    ` + getLanguage("community_write_button_add_youtube_video") + `
                </div>
            </div>
            
            <div class = "community_add_youtube_video">
                <div class = "community_add_youtube_video_state" value = "0">
                    <div class = "community_add_youtube_video_state_nothing">
                        <!-- Generated by IcoMoon.io -->
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.070c-1.884-1.821-3.053-4.37-3.053-7.193 0-5.523 4.477-10 10-10 2.823 0 5.372 1.169 7.19 3.050l0.003 0.003c1.737 1.796 2.807 4.247 2.807 6.947 0 5.523-4.477 10-10 10-2.7 0-5.151-1.070-6.95-2.81l0.003 0.003zM15.66 15.66c1.449-1.449 2.344-3.45 2.344-5.66 0-4.421-3.584-8.004-8.004-8.004-2.21 0-4.211 0.896-5.66 2.344v0c-1.449 1.449-2.344 3.45-2.344 5.66 0 4.421 3.584 8.004 8.004 8.004 2.21 0 4.211-0.896 5.66-2.344v0zM9 5h2v6h-2v-6zM9 13h2v2h-2v-2z"></path></svg>
                        ` + getLanguage("popup_contents_community_add_youtube_video_state_title:nothing") + `
                    </div>
                    <div class = "community_add_youtube_video_state_invalid">
                        <!-- Generated by IcoMoon.io -->
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M2.93 17.070c-1.884-1.821-3.053-4.37-3.053-7.193 0-5.523 4.477-10 10-10 2.823 0 5.372 1.169 7.19 3.050l0.003 0.003c1.737 1.796 2.807 4.247 2.807 6.947 0 5.523-4.477 10-10 10-2.7 0-5.151-1.070-6.95-2.81l0.003 0.003zM15.66 15.66c1.449-1.449 2.344-3.45 2.344-5.66 0-4.421-3.584-8.004-8.004-8.004-2.21 0-4.211 0.896-5.66 2.344v0c-1.449 1.449-2.344 3.45-2.344 5.66 0 4.421 3.584 8.004 8.004 8.004 2.21 0 4.211-0.896 5.66-2.344v0zM9 5h2v6h-2v-6zM9 13h2v2h-2v-2z"></path></svg>
                        ` + getLanguage("popup_contents_community_add_youtube_video_state_title:invalid") + `
                    </div>
                    <div class = "community_add_youtube_video_state_available">
                        <!-- Generated by IcoMoon.io -->
                        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.984 17.016l9-9-1.406-1.453-7.594 7.594-3.563-3.563-1.406 1.406zM12 2.016q4.125 0 7.055 2.93t2.93 7.055-2.93 7.055-7.055 2.93-7.055-2.93-2.93-7.055 2.93-7.055 7.055-2.93z"></path></svg>
                        ` + getLanguage("popup_contents_community_add_youtube_video_state_title:available") + `
                    </div>
                </div>

                <div class = "community_add_youtube_video_input">
                    <input type = "text" placeholder = "` + getLanguage("popup_contents_community_add_youtube_video_input_placeholder") + `" onkeydown = "setTimeout(() => { popupContentsCheckStateCommunityAddYoutubeVideo(); }, 1);" onfocus = "popupContentsCommunityAddYoutubeVideoInputFocus(this);" onblur = "popupContentsCommunityAddYoutubeVideoInputBlur(this);">
                    <div class = "community_add_youtube_video_input_line_wrap"></div>
                </div>

                <div class = "community_add_youtube_video_example" style = "display: none;">
                    <div class = "community_add_youtube_video_title" style = "margin-bottom: 10px;">
                        ` + getLanguage("popup_contents_community_add_youtube_video_example_title") + `
                    </div>
                    <div class = "community_add_youtube_video_example_iframe"></div>
                </div>

                <div class = "community_add_youtube_video_bottom">
                    <div class = "community_add_youtube_video_bottom_button md-ripples community_add_youtube_video_bottom_button_disabled" onclick = "popupContentsCommunityAddYoutubeVideoAddButton();">
                        <div class = "community_add_youtube_video_bottom_button_icon">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="50" height="50" viewBox="0 0 50 50"><defs><clipPath id="b"><rect width="50" height="50"></rect></clipPath></defs><g id="a" clip-path="url(#b)"><path d="M-4.438,42.27v0L.4,28.587,21.847,7.145a2.12,2.12,0,0,1,1.506-.632,1.945,1.945,0,0,1,1.387.567l7.071,7.071a1.944,1.944,0,0,1,.567,1.433,2.125,2.125,0,0,1-.632,1.459L10.3,38.487-4.436,42.27ZM23.387,9.839h0L3.162,30.064-.327,38.621l9.154-2.892L29.052,15.5,23.387,9.839Z" transform="translate(5.102 6.536)"></path><path d="M28.7,19.1a1.987,1.987,0,0,1-1.414-.586l-7.071-7.071a2,2,0,0,1,0-2.828l6.368-6.368a2,2,0,0,1,2.829,0l7.071,7.071a2,2,0,0,1,0,2.828L30.116,18.51A1.987,1.987,0,0,1,28.7,19.1ZM27.995,5.067h0l-4.95,4.95,5.666,5.665,4.95-4.949L27.995,5.067Z" transform="translate(12.102 -0.464)"></path></g></svg>
                        </div>
                        <div class = "community_add_youtube_video_bottom_button_right">
                            ` + getLanguage("popup_contents_community_add_youtube_video_bottom_button_title") + `
                        </div>
                    </div>
                </div>
            </div>
            <div style = "width: 600px"></div>
        </div>
    `;

    return html;
}

function popupContentsCommunityAddYoutubeVideoInputFocus(input) {
    let parent = input.parentElement;
    parent.classList.add("community_add_youtube_video_input_focus");
}
function popupContentsCommunityAddYoutubeVideoInputBlur(input) {
    let parent = input.parentElement;
    parent.classList.remove("community_add_youtube_video_input_focus");
}

function popupContentsCheckStateCommunityAddYoutubeVideo() {
    let state = document.getElementsByClassName("community_add_youtube_video_state")[0];
    let example = document.getElementsByClassName("community_add_youtube_video_example")[0];
    let iframe = example.getElementsByClassName("community_add_youtube_video_example_iframe")[0];
    let button = document.getElementsByClassName("community_add_youtube_video_bottom_button")[0];
    let input = document.getElementsByClassName("community_add_youtube_video_input")[0].getElementsByTagName("input")[0];
    let value = input.value.trim();

    checkHtmlPopupContents();

    if (value == "") {
        state.setAttribute("value", 0);
        example.style.display = "none";
        button.classList.add("community_add_youtube_video_bottom_button_disabled");
    } else {
        let videoId = youtubeParser(value);
        
        if (videoId == false) {
            state.setAttribute("value", 1);
            example.style.display = "none";
            button.classList.add("community_add_youtube_video_bottom_button_disabled");
        } else {
            state.setAttribute("value", 2);
            example.style.display = null;

            if (iframe.getAttribute("video_id") != videoId) {
                iframe.setAttribute("video_id", videoId);
                iframe.innerHTML = `
                    <iframe src="https://www.youtube.com/embed/` + videoId + `" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                `;
            }
            button.classList.remove("community_add_youtube_video_bottom_button_disabled");
        }
    }
}

function popupContentsCommunityAddYoutubeVideoAddButton() {
    let menuNumber = getCurrentMenuNumber();
    let contents = document.getElementById("contents_" + menuNumber);

    let communityWrite = contents.getElementsByClassName("community_write");
    if (communityWrite.length != 0) {
        let example = document.getElementsByClassName("community_add_youtube_video_example")[0];
        let iframe = example.getElementsByClassName("community_add_youtube_video_example_iframe")[0];

        let videoId = iframe.getAttribute("video_id");
        communityWriteOptionAddYouTubeVideo(communityWrite[0], videoId);
    }

    history.back();
}